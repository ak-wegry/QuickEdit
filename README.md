# ![](https://github.com/ak-wegry/QuickEdit/blob/main/images/QuickEdit.png) QuickEdit
クリップボード内文字編集ツール

QuickEditはクリップボード内にコピーされた文字列を編集します。  
(全角/半角変換、行結合、行頭/行末の空白削除等)  
また、クリップボード内の文字列がフォルダ名やファイル名の場合、  
該当フォルダを表示した状態でエクスプローラーを起動したり、  
ファイルに関連付けられたアプリケーションを起動することができます。

## 動作環境
- Windows10

## コンパイラ
- Borland C++ 5.5.1 for Win32
- 環境変数`LIB`にコンパイラのLibフォルダのパスを設定

## 使い方
- `QuickEdit.exe`と`QuickEdit.chm`をPCローカルの適当なフォルダに格納して、
起動します。  
(起動すると同一フォルダに、設定/履歴情報などを保存するQuickEdit.iniを作成します)
![](https://github.com/ak-wegry/QuickEdit/blob/main/images/QuickEdit_Image.png)
- クリップボードに文字列をコピーして、QuickEditをActivateします。  
(HotKey(Ctrl+Shift+Q)でActivateが可能)
- QuickEdit上で文字列を編集するキー操作を行います。  
(クリップボード内の文字列が編集した内容で書き換わります)
- Alt+TabでWindowを切替え(元のWindowをActivate)、ペーストします。

## 機能
### 文字列の編集/各種操作
アプリ内でのKey操作は、以下の方法で確認できます。
- メニュー「ヘルプ - ヘルプ表示」による詳細ヘルプ
- メニューの項目名(右端)に表示した操作Key
- '?'キー押下による簡易ヘルプ

|    |編集内容/各種操作                                           |Key操作  |
|----|------------------------------------------------------------|:-------:|
|1   |編集を元に戻す                                              |Ctrl+Z   |
|2-1 |行頭/行末の`Tab` ` `(半角スペース) `　`(全角スペース)+行頭の`>`を削除|t        |
|2-2 |行頭/行末の`Tab` ` `(半角スペース)を削除                    |Tb       | 
|2-3 |行頭/行末の`Tab` ` `(半角スペース) `　`(全角スペース)を削除 |Tz       |
|2-4 |行頭の`Tab` ` `(半角スペース)を削除                         |Th       |
|2-5 |行頭の`Tab` ` `(半角スペース) `>`を削除                     |T>       |
|2-6 |行末の`Tab` ` `(半角スペース)を削除                         |Te       |
|3-1 |行頭の空白インデントを増加                                  |+        |
|3-2 |行頭の空白インデントを減少                                  |-        |
|4-1 |英数字/記号/カナを全角に変換                                |z        |
|4-2 |英数字/記号/カナを半角に変換                                |H        |
|4-3 |英数字/記号を半角に変換                                     |h        |
|5-1 |英字を大文字に変換                                          |u        |
|5-2 |英字を小文字に変換                                          |l        |
|6   |複数行を1行に結合                                           |j        |
|7   |文字編集を開始(ESCキーで編集終了)                           |i        |
|8-1 |括り文字の変更                                              |"        |
|8-2 |日付文字の書式変更                                          |d        |
|8-3 |ファイル名のツリー形式表示変更                              |y        |
|8-4 |改行コードを変換(LF→CRLF)                                  |Cr       |
|8-5 |改行コードを変換(CRLF→LF)                                  |Cl       |
|9-1 |行を昇順にソート(自然順)                                    |Sa       |
|9-2 |行を降順にソート(自然順)                                    |Sd       |
|9-3 |行を昇順にソート(文字コード順)                              |SA       |
|9-4 |行を降順にソート(文字コード順)                              |SD       |
|10-1|指定した検索文字列から置換文字列に変換                      |R        |
|10-2|直前の検索文字列から置換文字列への変換を繰返す              |r        |
|11-1|指定した内容で書式を変換                                    |F        |
|11-2|直前の書式の変換を繰返す                                    |f        |
|12  |ダイアログにより指定した形式で日時を挿入                    |D        |
|13-1|マクロの実行/新規/取込/編集/削除を行う                      |M        |
|13-2|直前のマクロ実行を繰返す                                    |m        |
|14-1|1ページ下にスクロール                                       |Space    |
|14-2|1ページ上にスクロール                                       |b        |
|14-3|1画面右にスクロール                                         |>        |
|14-4|1画面左にスクロール                                         |<        |
|15  |クリップボード内の文字列(カーソル行)をファイルとして実行    |e        |
|16  |エクスプローラーからDrag＆Dropによるファイル名のフルパス取得|         |
|17  |ツールのウィンドウ最小化によるクリップボード読込み処理の抑制|         |
|18  |Key操作のヘルプ表示('q'キーで表示終了)                      |?        |

### 8-1 括り文字の変更  
クリップボード内の文字列全体が、以下の文字で括られている場合、
キー押下毎に括り文字を変更します。  
`""` `()` `<>` `[]` `「」` `【】` `（）` `＜＞` `“”`  

- 括られている　 ⇒ 括り文字を削除
- 括られていない ⇒ 括り文字を順番に変更

### 8-2 日付文字の書式変更 
クリップボード内で最初に見つかった日付文字の書式をキー押下毎に変更します。  
年月日と曜日の組合せが間違っている場合は、初回キー押下で曜日を補正します。  
- 日本語書式  
　mmdd, m/d, m/d(w), m月d日, m月d日(w),  
　yyyymmdd, y/m/d, y/m/d(w), y年m月d日, y年m月d日(w)  
　例. 2017年5月4日(木)

- 英語書式  
　week, month day, year  
　例. Thursday, May 4, 2017

### 8-3 ファイル名のツリー形式表示変更
ファイル名(フルパス)をツリー形式表示へキー押下毎に変更します。  
　例.
        
     C:\usr\doc\aaa.txt
     C:\usr\doc\bbb.txt
     　↓(変更)
     C:\usr\doc
     ├ aaa.txt
     └ bbb.txt
     　↓(変更)
     C:\usr
     └ doc
     　 ├ aaa.txt
     　 └ bbb.txt

### 9-1 行を昇順にソート(自然順)
行を昇順にソート(自然順)します。  
　例. file1.txt, file2.txt, file3.txt, file10.txt, file20.txt

### 9-3 行を昇順にソート(文字コード順)
行を昇順にソート(文字コード順)します。  
　例. file1.txt, file10.txt, file2.txt, file20.txt, file3.txt

### 10-1 指定した検索文字列から置換文字列に変換
- パラメータ入力のダイアログに
「/`検索文字1`/`置換文字1`/[`検索文字2`/`置換文字2`/...]」形式で指定します。
- 検索文字にはワイルドカードによる指定が可能  
(?：任意の1文字、*：任意の0文字以上の文字列)
- 指定可能な制御コード(タブ：\t、改行：\n、復帰：\r、改ページ：\f)
- 検索文字と置換文字は、先頭の1文字を区切り文字として複数指定可能

### 11-1 指定した内容で書式を変換
- パラメータ入力のダイアログで、種別/書式/区切り文字を選択/設定して実行します。
![](https://github.com/ak-wegry/QuickEdit/blob/main/images/QuickEdit_Format.png)

1. HTMLのソースコードに適切なインデントと改行を付けて整形
2. カラムデータを指定した書式に従って変換  
(書式内の%1, %2,... をカラムデータで置換え)  
　例.  
    ・Clipborad内データ
        
        file1.txt,20211001
        file2.txt,20211002
        file3.txt,20211003

    ・書式 `mv %1 %2_%1`  
    ・変換結果
        
        mv file1.txt 20211001_file1.txt
        mv file2.txt 20211002_file2.txt
        mv file3.txt 20211003_file3.txt

3. カラムデータを罫線文字によるテキスト表に変換  
　例.  
    ・Clipborad内データ
        
        USA,1
        UK,44
        Japan,81

    ・変換結果
        
        ┌──────┬──┐
        │USA   │ 1│
        ├──────┼──┤
        │UK    │44│
        ├──────┼──┤
        │Japan │81│
        └──────┴──┘

4. 指定した文字列を含む行を抽出(*)
5. 指定した文字列を含まない行を抽出(*)  
*：指定した文字が無いの場合、空行を含む/含まない行を抽出する

### 12 ダイアログにより指定した形式で日時を挿入
ダイアログにより指定した形式で日時をクリップボードへ設定します。  
![](https://github.com/ak-wegry/QuickEdit/blob/main/images/QuickEdit_DateTime.png)

- 設定形式
	- 1：年月日+開始時刻～終了時刻
	- 2：年月日+時刻
	- 3：年月日
- 初期値
	- 年月日：現在日
	- 時刻：現在時刻(設定形式1：30分単位、設定形式2：1分単位)
- 日時変更操作

|項目    |操作キー  |値の変化, <項目移動>                           |
|--------|----------|-----------------------------------------------|
|年月日  |          |                                               |
|        |j, ↓     |+1日                                           |
|        |J, Ctrl+↓|+7日                                           |
|        |k, ↑     |-1日                                           |
|        |K, Ctrl+↑|-7日                                           |
|        |l, →     |<設定形式1,2 ⇒ 開始時刻>                      |
|        |h, ←     |<設定形式1 ⇒ 終了時刻、<設定形式2 ⇒ 開始時刻>|
|開始時刻|          |                                               |
|        |j, ↓     |+30分 (終了時刻も連動して+30分)                |
|        |J, Ctrl+↓|+1時間(終了時刻も連動して+1時間)               |
|        |k, ↑     |-30分 (終了時刻も連動して-30分)                |
|        |K, Ctrl+↑|-1時間(終了時刻も連動して-1時間)               |
|        |l, →     |<設定形式1 ⇒ 終了時刻>、<設定形式2 ⇒ 年月日> |
|        |h, ←     |<設定形式1 ⇒ 年月日>                          |
|終了時刻|          |                                               |
|        |j, ↓     |+30分                                          |
|        |J, Ctrl+↓|+1時間                                         |
|        |k, ↑     |-30分 (終了時刻≦開始時刻 ⇒ 開始時刻を-30分)  |
|        |K, Ctrl+↑|-1時間(終了時刻≦開始時刻 ⇒ 開始時刻を-1時間) |
|        |l, →     |<設定形式1 ⇒ 年月日>                          |
|        |h, ←     | <設定形式1 ⇒ 開始時刻>                       |
